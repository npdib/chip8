#pragma once
#include <cstdint>

namespace npdib
{
	class Chip8
	{
	public:
		Chip8();
		~Chip8();
		void load_program(uint8_t* program);
		void run();
		uint8_t* get_display_data() { return ram + 0x0F00; }

	private:
		static constexpr uint8_t font[] = { 
			0xF0, 0x90, 0x90, 0x90, 0xF0, // 0
			0x20, 0x60, 0x20, 0x20, 0x70, // 1
			0xF0, 0x10, 0xF0, 0x80, 0xF0, // 2
			0xF0, 0x10, 0xF0, 0x10, 0xF0, // 3
			0x90, 0x90, 0xF0, 0x10, 0x10, // 4
			0xF0, 0x80, 0xF0, 0x10, 0xF0, // 5
			0xF0, 0x80, 0xF0, 0x90, 0xF0, // 6
			0xF0, 0x10, 0x20, 0x40, 0x40, // 7
			0xF0, 0x90, 0xF0, 0x90, 0xF0, // 8
			0xF0, 0x90, 0xF0, 0x10, 0xF0, // 9
			0xF0, 0x90, 0xF0, 0x90, 0x90, // A
			0xE0, 0x90, 0xE0, 0x90, 0xE0, // B
			0xF0, 0x80, 0x80, 0x80, 0xF0, // C
			0xE0, 0x90, 0x90, 0x90, 0xE0, // D
			0xF0, 0x80, 0xF0, 0x80, 0xF0, // E
			0xF0, 0x80, 0xF0, 0x80, 0x80  // F
		};

		/*
		0x0000 - 0x0049:	UNUSED
		0x0050 - 0x009F:	FONT
		0x00A0 - 0x01FF:	UNUSED
		0x0200 - 0x0E9F:	PROGRAM DATA
		0x0EA0 - 0x0EAF:	REGISTERS V0-VF
		0x0EB0 - 0x0EFF:	CALL STACK
		0x0F00 - 0x0FFF:	DISPLAY DATA
		*/
		uint8_t ram[4096];
		uint8_t* stack_pointer;


		uint8_t delay;
		uint8_t sound;

		void push(uint8_t data);
		uint8_t pop(uint8_t data);
	};

}